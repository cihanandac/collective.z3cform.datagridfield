!function(){var t={666:function(t){var e=function(t){"use strict";var e,n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function d(t,e,n,r){var o=e&&e.prototype instanceof v?e:v,i=Object.create(o.prototype),a=new I(r||[]);return i._invoke=function(t,e,n){var r=u;return function(o,i){if(r===f)throw new Error("Generator is already running");if(r===p){if("throw"===o)throw i;return T()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=A(a,n);if(s){if(s===g)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===u)throw r=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=f;var l=c(t,e,n);if("normal"===l.type){if(r=n.done?p:h,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r=p,n.method="throw",n.arg=l.arg)}}}(t,n,a),i}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=d;var u="suspendedStart",h="suspendedYield",f="executing",p="completed",g={};function v(){}function w(){}function y(){}var m={};l(m,i,(function(){return this}));var b=Object.getPrototypeOf,_=b&&b(b(S([])));_&&_!==n&&r.call(_,i)&&(m=_);var x=y.prototype=v.prototype=Object.create(m);function E(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function n(o,i,a,s){var l=c(t[o],t,i);if("throw"!==l.type){var d=l.arg,u=d.value;return u&&"object"==typeof u&&r.call(u,"__await")?e.resolve(u.__await).then((function(t){n("next",t,a,s)}),(function(t){n("throw",t,a,s)})):e.resolve(u).then((function(t){d.value=t,a(d)}),(function(t){return n("throw",t,a,s)}))}s(l.arg)}var o;this._invoke=function(t,r){function i(){return new e((function(e,o){n(t,r,e,o)}))}return o=o?o.then(i,i):i()}}function A(t,n){var r=t.iterator[n.method];if(r===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,A(t,n),"throw"===n.method))return g;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var o=c(r,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function R(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(R,this),this.reset(!0)}function S(t){if(t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}return{next:T}}function T(){return{value:e,done:!0}}return w.prototype=y,l(x,"constructor",y),l(y,"constructor",w),w.displayName=l(y,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,l(t,s,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},E(L.prototype),l(L.prototype,a,(function(){return this})),t.AsyncIterator=L,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new L(d(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(x),l(x,s,"Generator"),l(x,i,(function(){return this})),l(x,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=S,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return s.type="throw",s.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var l=r.call(a,"catchLoc"),d=r.call(a,"finallyLoc");if(l&&d){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!d)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),O(n),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;O(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:S(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}(t.exports);try{regeneratorRuntime=e}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r](i,i.exports,n),i.exports}n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},n.d=function(t,e){for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){"use strict";var t=jQuery,e=n.n(t);const r={},o=(t,e)=>{if(!t?.removeEventListener)return;const n=r[t];if(!n)return;let o;if(e){const t=n[e];o=t?[t]:[]}else o=Object.entries(n);for(const e of o||[])t.removeEventListener(e[0],e[1],e[2])};var i={add_event_listener:(t,e,n,i,a={})=>{t?.addEventListener&&(o(t,n),r[t]||(r[t]={}),r[t][n]=[e,i,a.capture?a:void 0],t.addEventListener(e,i,a))},remove_event_listener:o,await_event:(t,e)=>new Promise((n=>t.addEventListener(e,n,{once:!0}))),await_pattern_init:t=>new Promise((e=>t.one("init",e))),click_event:()=>new Event("click",{bubbles:!0,cancelable:!0}),change_event:()=>new Event("change",{bubbles:!0,cancelable:!1}),input_event:()=>new Event("input",{bubbles:!0,cancelable:!1}),scroll_event:()=>new Event("scroll",{bubbles:!0,cancelable:!1}),submit_event:()=>new Event("submit",{bubbles:!0,cancelable:!0})};const a="__patternslib__style__display";function s(t,e,n=!1,r=!1){let o=window.getComputedStyle(t).getPropertyValue(e);return(n||r)&&(o=parseFloat(o)||0),n&&!r&&(o=parseInt(Math.round(o),10)),o}var l,d,c={toNodeArray:t=>(t.jquery||t instanceof NodeList?t=[...t]:t instanceof Array==!1&&(t=[t]),t),querySelectorAllAndMe:(t,e)=>{if(!t)return[];const n=[...t.querySelectorAll(e)];return t.matches(e)&&n.unshift(t),n},wrap:(t,e)=>{t.parentNode.insertBefore(e,t),e.appendChild(t)},hide:t=>{"none"!==t.style.display&&(t.style.display&&(t[a]=t.style.display),t.style.display="none",t.setAttribute("hidden",""))},show:t=>{const e=t[a]||null;t.style.display=e,delete t[a],t.removeAttribute("hidden","")},find_parents:(t,e)=>{const n=[];let r=t?.parentNode?.closest?.(e);for(;r;)n.push(r),r=r.parentNode?.closest?.(e);return n},find_scoped:(t,e)=>(0===e.indexOf("#")?document:t).querySelectorAll(e),get_parents:t=>{const e=[];let n=t?.parentNode;for(;n;)e.push(n),n=n?.parentNode,n=n instanceof HTMLElement?n:null;return e},acquire_attribute:(t,e,n=!1,r=!1)=>{let o=t;const i=[];for(;o;){const t=o.getAttribute(e);if(t||n&&""===t){if(!r)return t;i.push(t)}o=o.parentElement}if(r)return i},is_visible:t=>t.offsetWidth>0&&t.offsetHeight>0,create_from_string:t=>document.createRange().createContextualFragment(t.trim()),get_css_value:s,find_scroll_container:(t,e,n=document.body)=>{for(;t&&t!==document.body;){if(!e||"y"===e){let e=s(t,"overflow-y");if(["auto","scroll"].includes(e))return t}if(!e||"x"===e){let e=s(t,"overflow-x");if(["auto","scroll"].includes(e))return t}t=t.parentElement}return n},add_event_listener:i.add_event_listener,remove_event_listener:i.remove_event_listener};Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var e=Array.prototype.slice.call(arguments,1),n=this,r=function(){},o=function(){return n.apply(this instanceof r&&t?this:t,e.concat(Array.prototype.slice.call(arguments)))};return r.prototype=this.prototype,o.prototype=new r,o});var u={DEBUG:10,INFO:20,WARN:30,ERROR:40,FATAL:50};function h(){}function f(t,e){this._loggers={},this.name=t||"",this._parent=e||null,e||(this._enabled=!0,this._level=u.WARN)}function p(t){d=t}h.prototype={output:function(t,e,n){t&&n.unshift(t+":"),e<=u.DEBUG?(n.unshift("[DEBUG]"),console.log.apply(console,n)):e<=u.INFO?console.info.apply(console,n):e<=u.WARN?console.warn.apply(console,n):console.error.apply(console,n)}},f.prototype={getLogger:function(t){for(var e=t.split("."),n=this,r=this.name?[this.name]:[];e.length;){var o=e.shift();r.push(o),o in n._loggers||(n._loggers[o]=new f(r.join("."),n)),n=n._loggers[o]}return n},_getFlag:function(t){var e=this;for(t="_"+t;null!==e;){if(void 0!==e[t])return e[t];e=e._parent}return null},setEnabled:function(t){this._enabled=!!t},isEnabled:function(){this._getFlag("enabled")},setLevel:function(t){"number"==typeof t?this._level=t:"string"==typeof t&&(t=t.toUpperCase())in u&&(this._level=u[t])},getLevel:function(){return this._getFlag("level")},log:function(t,e){!e.length||!this._getFlag("enabled")||t<this._getFlag("level")||(e=Array.prototype.slice.call(e),d.output(this.name,t,e))},debug:function(){this.log(u.DEBUG,arguments)},info:function(){this.log(u.INFO,arguments)},warn:function(){this.log(u.WARN,arguments)},error:function(){this.log(u.ERROR,arguments)},fatal:function(){this.log(u.FATAL,arguments)}},p(new h),l=new f;for(var g,v=/loglevel(|-[^=]+)=([^&]+)/g;null!==(g=v.exec(window.location.search));){(""===g[1]?l:l.getLogger(g[1].slice(1))).setLevel(g[2].toUpperCase())}var w={Level:u,getLogger:l.getLogger.bind(l),setEnabled:l.setEnabled.bind(l),isEnabled:l.isEnabled.bind(l),setLevel:l.setLevel.bind(l),getLevel:l.getLevel.bind(l),debug:l.debug.bind(l),info:l.info.bind(l),warn:l.warn.bind(l),error:l.error.bind(l),fatal:l.fatal.bind(l),getWriter:function(){return d},setWriter:p};e().fn.safeClone=function(){var t=this.clone();return window.document.documentMode&&t.findInclusive(":input[placeholder]").each((function(t,n){var r=e()(n);r.attr("placeholder")===r.val()&&r.val("")})),t},Array.prototype.forEach||(Array.prototype.forEach=function(t,e){var n,r;if(null===this)throw new TypeError(" this is null or not defined");var o=Object(this),i=o.length>>>0;if("function"!=typeof t)throw new TypeError(t+" is not a function");for(arguments.length>1&&(n=e),r=0;r<i;){var a;r in o&&(a=o[r],t.call(n,a,r,o)),r++}});var y=function(t,n,r){return this.each((function(){var o,i=e()(this);if(o=t.init(i,r),n){if(void 0===o[n])return e().error("Method "+n+" does not exist on jQuery."+t.name),!1;if("_"===n.charAt(0))return e().error("Method "+n+" is private on jQuery."+t.name),!1;o[n].apply(o,[r])}})),this},m=function(t,n,r){var o=this;if(n){if(t[n])return t[n].apply(o,[o].concat([r]));e().error("Method "+n+" does not exist on jQuery."+t.name)}else t.init.apply(o,[o].concat([r]));return o};function b(t){var e=typeof t;return"function"===e||"object"===e&&!!t}var _={jqueryPlugin:function(t){return function(e,n){return 0===this.length?this:("object"==typeof e&&(n=e,e=void 0),"function"==typeof t?y.call(this,t,e,n):m.call(this,t,e,n))}},escapeRegExp:function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isObject:b,extend:function(t){if(!b(t))return t;for(var e,n,r=1,o=arguments.length;r<o;r++)for(n in e=arguments[r])hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},rebaseURL:function(t,e){return t=new URL(t,window.location).href,-1!==e.indexOf("://")||"/"===e[0]||0===e.indexOf("data:")?e:t.slice(0,t.lastIndexOf("/")+1)+e},findLabel:function(t){for(var n,r=t.parentNode;r&&11!==r.nodeType;r=r.parentNode)if("LABEL"===r.tagName)return r;return t.id&&(n=e()('label[for="'+t.id+'"]')),n&&0===n.length&&t.form&&(n=e()('label[for="'+t.name+'"]',t.form)),n&&n.length?n[0]:null},elementInViewport:function(t){var e=t.getBoundingClientRect(),n=document.documentElement,r=window.innerWidth||n.clientWidth,o=window.innerHeight||n.clientHeight;return!(e.right<0||e.bottom<0||e.left>r||e.top>o)},removeWildcardClass:function(t,e){if(t=_.ensureArray(t),-1===e.indexOf("*"))for(const n of t)n.classList.remove(e);else{let n=e.replace(/[\-\[\]{}()+?.,\\\^$|#\s]/g,"\\$&");n=n.replace(/[*]/g,".*"),n=new RegExp("^"+n+"$");for(const e of t){const t=(e.getAttribute("class")||"").split(/\s+/);if(!t.length)continue;const r=t.filter((t=>!n.test(t)));r.length?e.setAttribute("class",r.join(" ")):e.removeAttribute("class")}}},hideOrShow:(t,n,r,o)=>{t=c.toNodeArray(t);const i={none:{hide:"hide",show:"show"},fade:{hide:"fadeOut",show:"fadeIn"},slide:{hide:"slideUp",show:"slideDown"}},a="css"===r.transition||"none"===r.transition?null:r.effect.duration,s=t=>{t.classList.remove("in-progress"),t.classList.add(n?"visible":"hidden"),e()(t).trigger("pat-update",{pattern:o,transition:"complete"})};for(const l of t)if(l.classList.remove("visible"),l.classList.remove("hidden"),l.classList.remove("in-progress"),a){const t=i[r.transition];l.classList.add("in-progress"),e()(l).trigger("pat-update",{pattern:o,transition:"start"}),e()(l)[n?t.show:t.hide]({duration:a,easing:r.effect.easing,complete:()=>s(l)})}else"css"!==r.transition&&c[n?"show":"hide"](l),s(l)},addURLQueryParameter:function(t,e,n){var r=new RegExp("(\\?|\\&)"+e+"=.*?(?=(&|$))"),o=t.toString().split("#"),i=o[0],a=o[1],s=i;return s=r.test(i)?i.replace(r,"$1"+e+"="+n):/\?.+$/.test(i)?i+"&"+e+"="+n:i+"?"+e+"="+n,a&&(s+="#"+a),s},removeDuplicateObjects:function(t){const e=function(t,e){return this[t]===e};return t.reduce((function(t,n){let r=!1;for(const o of t)r=Object.keys(o).length===Object.keys(n).length&&0===Object.entries(o).filter((t=>!e.bind(n)(t[0],t[1]))).length;return r||t.push(n),t}),[])},mergeStack:function(t,n){const r=[];for(let t=0;t<n;t++)r.push({});for(const o of t){const t=o.length-1;for(let i=0;i<n;i++)r[i]=e().extend(r[i]||{},o[i>t?t:i])}return r},isElementInViewport:function(t,n=!1,r=0){t instanceof e()&&(t=t[0]);const o=t.getBoundingClientRect();return![o.top,o.bottom,o.left,o.right].every((t=>0===t))&&(n?o.top<=0+r&&o.bottom>=0+r:o.top>=0&&o.left>=0&&o.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&o.right<=(window.innerWidth||document.documentElement.clientWidth))},hasValue:function(t){return"INPUT"===t.tagName?"checkbox"===t.type||"radio"===t.type?t.checked:""!==t.value:"SELECT"===t.tagName?-1!==t.selectedIndex:"TEXTAREA"===t.tagName&&""!==t.value},parseTime:function(t){var e=/^(\d+(?:\.\d+)?)\s*(\w*)/.exec(t);if(!e)throw new Error("Invalid time");var n=parseFloat(e[1]);switch(e[2]){case"s":return Math.round(1e3*n);case"m":return Math.round(1e3*n*60);default:return Math.round(n)}},findRelatives:function(t){var n=e()(t),r=e()(t),o=e()();if(r=(r=r.add(n.closest("label"))).add(n.closest("fieldset")),t.id&&(o=e()("label[for='"+t.id+"']")),!o.length){var i=n.closest("form");i.length||(i=e()(document.body)),o=i.find("label[for='"+t.name+"']")}return r=r.add(o)},get_bounds:function(t){const e=t.getBoundingClientRect();return{x:parseInt(Math.round(e.x),10)||0,y:parseInt(Math.round(e.y),10)||0,top:parseInt(Math.round(e.top),10)||0,bottom:parseInt(Math.round(e.bottom),10)||0,left:parseInt(Math.round(e.left),10)||0,right:parseInt(Math.round(e.right),10)||0,width:parseInt(Math.round(e.width),10)||0,height:parseInt(Math.round(e.height),10)||0}},checkInputSupport:function(t,e){let n=!1;const r=document.createElement("input");return r.setAttribute("type",t),n=r.type==t,void 0!==e&&(r.setAttribute("value",e),n=r.value!==e),n},checkCSSFeature:(t,e,n="div")=>{let r=void 0!==(n=document.createElement(n)).style[t];return r&&void 0!==e&&(n.style[t]=e,r=n.style[t]===e),r},animation_frame:()=>new Promise(window.requestAnimationFrame),timeout:t=>new Promise((e=>setTimeout(e,t))),debounce:(t,e,n={timer:null})=>function(){clearTimeout(n.timer);const r=arguments;n.timer=setTimeout((()=>t.apply(this,r)),e)},isIE:()=>!!document.documentMode,jqToNode:t=>(t.jquery&&(t=t[0]),t),ensureArray:(t,e)=>!!(NodeList.prototype.isPrototypeOf(t)||Array.isArray(t)||t.jquery)?e?[...t]:t:[t],localized_isodate:t=>{const e=t.getDate().toString().padStart(2,"0"),n=(t.getMonth()+1).toString().padStart(2,"0");return`${t.getFullYear().toString()}-${n}-${e}`},escape_html:t=>(t||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"),unescape_html:t=>(t||"").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"'),getCSSValue:c.get_css_value},x=_;const E=w.getLogger("registry"),L=/patterns-disable=([^&]+)/g,A=/patterns-dont-catch/g,R={};let O,I=!1;for(;null!==(O=L.exec(window.location.search));)R[O[1]]=!0,E.info("Pattern disabled via url config:",O[1]);for(;null!==(O=A.exec(window.location.search));)I=!0,E.info("I will not catch init exceptions");const S={patterns:{},initialized:!1,init(){e()(document).ready((function(){E.info("loaded: "+Object.keys(S.patterns).sort().join(", ")),S.scan(document.body),S.initialized=!0,E.info("finished initial scan.")}))},clear(){this.patterns={}},transformPattern(t,n){if(R[t])return void E.debug("Skipping disabled pattern:",t);const r=S.patterns[t],o=r.transform||r.prototype?.transform;if(o)try{o(e()(n))}catch(e){if(I)throw e;E.error("Transform error for pattern"+t,e)}},initPattern(t,n,r){const o=e()(n),i=S.patterns[t];if(i.init){const e=w.getLogger("pat."+t);if(o.is(i.trigger)){e.debug("Initialising:",o);try{i.init(o,null,r),e.debug("done.")}catch(t){if(I)throw t;e.error("Caught error:",t)}}}},orderPatterns:t=>(t.includes("validation")&&t.includes("inject")&&(t.splice(t.indexOf("validation"),1),t.unshift("validation")),t),scan(t,e,n){if(!t)return;"string"==typeof t?t=document.querySelector(t):t.jquery&&(t=t[0]);const r=[];e=this.orderPatterns(e||Object.keys(S.patterns));for(const n of e){this.transformPattern(n,t);const e=S.patterns[n];e.trigger&&r.unshift(e.trigger)}let o=c.querySelectorAllAndMe(t,r.map((t=>t.trim().replace(/,$/,""))).join(","));o=o.filter((t=>!(t.matches(".cant-touch-this")||t?.parentNode?.closest?.(".cant-touch-this")||t?.parentNode?.closest?.("pre")||t?.parentNode?.closest?.("template"))));for(const t of o.reverse())for(const r of e)this.initPattern(r,t,n);document.body.classList.add("patterns-loaded")},register(t,n){if(!(n=n||t.name))return E.error("Pattern lacks a name:",t),!1;if(S.patterns[n])return E.error("Already have a pattern called: "+n),!1;if(S.patterns[n]=t,t.jquery_plugin){const r=("pat-"+n).replace(/-([a-zA-Z])/g,(function(t,e){return e.toUpperCase()}));e().fn[r]=x.jqueryPlugin(t),e().fn[r.replace(/^pat/,"pattern")]=e().fn[r]}return E.debug("Registered pattern:",n,t),S.initialized&&S.scan(document.body,[n]),!0}};var T=S,j=(n(666),{getOptions(t,n,r){r=r||{},0===t.length||e().nodeName(t[0],"body")||(r=this.getOptions(t.parent(),n,r));let o={};if(0!==t.length&&(o=t.data("pat-"+n),o&&"string"==typeof o)){const t={};e().each(o.split(";"),(function(e,n){(n=n.split(":")).reverse();let r=n.pop();r=r.replace(/^\s+|\s+$/g,""),n.reverse();let o=n.join(":");o=o.replace(/^\s+|\s+$/g,""),t[r]=o})),o=t}return e().extend(!0,{},r,o)}});const q=w.getLogger("Patternslib Base"),N=function(t,n,r){t.jquery||(t=e()(t));const o=this.prototype.name,i=w.getLogger(`pat.${o}`);let a=t.data(`pattern-${o}`);if(void 0===a&&T.patterns[o])try{n="mockup"===this.prototype.parser?j.getOptions(t,o,n):n,a=new T.patterns[o](t,n,r)}catch(t){i.error(`Failed while initializing ${o} pattern.`,t)}return a},$=async function(t,n,r){t.jquery||(t=e()(t)),this.$el=t,this.el=t[0],this.options=e().extend(!0,{},this.defaults||{},n||{}),await this.init(t,n,r),this.$el.data(`pattern-${this.name}`,this),this.el[`pattern-${this.name}`]=this,this.emit("init")};$.prototype={constructor:$,on(t,e){this.$el.on(`${t}.${this.name}.patterns`,e)},one(t,e){this.$el.one(`${t}.${this.name}.patterns`,e)},emit(t,e){void 0===e&&(e=[]),this.$el.trigger(`${t}.${this.name}.patterns`,e)}},$.extend=function(t){const n=this;let r;if(!t)throw new Error("Pattern configuration properties required when calling Base.extend");r=Object.hasOwnProperty.call(t,"constructor")?t.constructor:function(){n.apply(this,arguments)},r.extend=$.extend,r.init=N,r.jquery_plugin=!0,r.trigger=t.trigger,r.parser=t?.parser||null;var o=function(){this.constructor=r};return o.prototype=n.prototype,r.prototype=new o,e().extend(!0,r.prototype,t),r.__super__=n.prototype,t.name?t.trigger?T.register(r,t.name):q.warn(`The pattern ${t.name} does not have a trigger attribute, it will not be registered.`):q.warn("This pattern without a name attribute will not be registered!"),r};var P=$;w.setLevel("INFO");w.getLogger("datagridfield");P.extend({name:"datagridfield",trigger:".pat-datagridfield",parser:"mockup",init:function(){this.el=this.$el[0],this.el_body=this.el.querySelector(".datagridwidget-body"),this.auto_append="false"!==(this.el.dataset.autoAppend||"true").toLowerCase(),this._defineHandler(),this.getVisibleRows().forEach((function(t){this.initRowUI(t)}),this),this.ensureMinimumRows()||this.updateOrderIndex(),this.initAutoAppendHandler(),this.el.dispatchEvent(new Event("afterdatagridfieldinit",{bubbles:!0,cancelable:!0}))},_defineHandler:function(){this.handler_auto_append=function(t){t&&t.stopPropagation(),t&&!t.target.closest(".datagridwidget-cell")||this.auto_append_row()}.bind(this),this.handler_auto_append_input=function(t){var e=t.currentTarget;e.classList.remove("auto-append"),e.dataset.oldIndex=e.dataset.index,delete e.dataset.index,this.updateOrderIndex(),e.removeEventListener("input",this.handler_auto_append_input)}.bind(this)},initRowUI:function(t){t.querySelectorAll(".dgf--row-add").forEach((function(e){e.addEventListener("click",function(e){e.preventDefault(),this.insertRow(t),this.updateOrderIndex()}.bind(this))}),this),t.querySelectorAll(".dgf--row-delete").forEach((function(e){e.addEventListener("click",function(e){e.preventDefault(),this.removeFieldRow(t)}.bind(this))}),this),t.querySelectorAll(".dgf--row-moveup").forEach((function(e){e.addEventListener("click",function(e){e.preventDefault(),this.moveRowUp(t)}.bind(this))}),this),t.querySelectorAll(".dgf--row-movedown").forEach((function(e){e.addEventListener("click",function(e){e.preventDefault(),this.moveRowDown(t)}.bind(this))}),this)},get_row_buttons:function(t){return{add:t.querySelector(".dgf--row-add"),delete:t.querySelector(".dgf--row-delete"),up:t.querySelector(".dgf--row-moveup"),down:t.querySelector(".dgf--row-movedown")}},setUIState:function(){for(var t=this.getVisibleRows(),e=0;e<t.length;e++){var n=t[e],r=this.get_row_buttons(n);if(!0===this.auto_append&&"AA"===n.dataset.index){if(r.add&&(r.add.disabled=!0),r.delete&&(r.delete.disabled=!0),r.up&&(r.up.disabled=!0),r.down&&(r.down.disabled=!0),e>0){var o=this.get_row_buttons(t[e-1]);o.down&&(o.down.disabled=!0)}}else 0===e?(r.add&&(r.add.disabled=!1),r.delete&&(r.delete.disabled=!1),r.up&&(r.up.disabled=!0),r.down&&(r.down.disabled=1===t.length)):e===t.length-1?(r.add&&(r.add.disabled=!1),r.delete&&(r.delete.disabled=!1),r.up&&(r.up.disabled=!1),r.down&&(r.down.disabled=!0)):(r.add&&(r.add.disabled=!1),r.delete&&(r.delete.disabled=!1),r.up&&(r.up.disabled=!1),r.down&&(r.down.disabled=!1))}},getRows:function(){return this.el_body.querySelectorAll(".datagridwidget-row")},getVisibleRows:function(){return this.el_body.querySelectorAll(".datagridwidget-row:not([data-index=TT])")},getLastRow:function(){return this.el_body.querySelector(".datagridwidget-row:last-child")},getLastVisibleRow:function(){var t=this.el_body.querySelectorAll(".datagridwidget-row:not([data-index=TT])");return t[t.length-1]},countRows:function(){var t=0;return this.getRows().forEach((function(e){-1===["AA","TT"].indexOf(e.dataset.index)&&t++}),this),t},initAutoAppendHandler:function(){if(this.auto_append){this.getVisibleRows().forEach((function(t){t.removeEventListener("focusout",this.handler_auto_append)}),this);var t=this.getLastVisibleRow();t&&t.addEventListener("focusout",this.handler_auto_append)}},auto_append_row:function(){this.el.dispatchEvent(new Event("beforeaddrowauto")),this.getVisibleRows().forEach((function(t){t.classList.remove("auto-append"),"TT"!==t.dataset.index&&(t.dataset.oldIndex=t.dataset.index,delete t.dataset.index)}));var t=this.getLastVisibleRow()||this.getLastRow(),e=this.insertRow(t);e.classList.add("auto-append"),this.reindexRow(e,"AA"),this.updateOrderIndex(),e.addEventListener("input",this.handler_auto_append_input),this.el.dispatchEvent(new Event("afteraddrowauto"))},insertRow:function(t,n){var r=this.createNewRow(),o=e()(r);return this.$el.trigger("beforeaddrow",[this.$el,o]),n?o.insertBefore(t):o.insertAfter(t),this.initRowUI(r),T.scan(o),this.initAutoAppendHandler(),this.$el.trigger("afteraddrow",[this.$el,o]),r},createNewRow:function(){var t=this.el_body.querySelector("[data-index=TT]");if(!t)throw new Error("Could not locate empty template row in DGF");var n=document.createElement("table");return n.innerHTML=t.outerHTML,(n=n.querySelector("tr")).dataset.oldIndex=n.dataset.index,delete n.dataset.index,n.classList.remove("datagridwidget-empty-row"),e()(n).find('*[class^="dgw-disabled-pat-"]').attr("class",(function(t,e){return e.replace(/dgw\-disabled-pat-/,"pat-")})),n},removeFieldRow:function(t){e()(t).remove(),this.ensureMinimumRows()||this.updateOrderIndex(),this.updateOrderIndex(),this.initAutoAppendHandler()},moveRowDown:function(t){this.moveRow(t,"down"),this.updateOrderIndex(),this.initAutoAppendHandler()},moveRowUp:function(t){this.moveRow(t,"up"),this.updateOrderIndex(),this.initAutoAppendHandler()},moveRowToTop:function(t){var n=this.getRows();e()(t).insertBefore(n[0]),this.updateOrderIndex(),this.initAutoAppendHandler()},moveRowToBottom:function(t){var n=this.getRows(),r=0;e()(n).each((function(t,e){-1===["AA","TT"].indexOf(e.dataset.index)&&(r=t)})),e()(t).insertAfter(n[r]),this.updateOrderIndex(),this.initAutoAppendHandler()},moveRow:function(t,n){var r,o=this.getRows(),i=null;if(e()(o).each((function(e,n){t===n&&(i=e)})),null!==i){var a=this.countRows();i+1==a?"down"==n?this.moveRowToTop(t):(r=o[i-1],this.shiftRow(r,t)):0===i?"up"==n?this.moveRowToBottom(t):(r=o[parseInt(i+1,10)],this.shiftRow(t,r)):"up"==n?(r=o[i-1],this.shiftRow(r,t)):(r=o[parseInt(i+1,10)],this.shiftRow(t,r)),this.$el.trigger("aftermoverow",[this.$el,t])}},shiftRow:function(t,n){e()(n).insertBefore(t)},reindexRow:function(t,e){var n=this.el_body.dataset.name_prefix+".",r=this.el_body.dataset.id_prefix+"-",o=t.dataset.oldIndex||t.dataset.index;function i(t,n,r){var i=t.getAttribute(n);if(i){var a=new RegExp("^"+r+o);t.setAttribute(n,i.replace(a,r+e))}}delete t.dataset.oldIndex,t.dataset.index=e,t.querySelectorAll('[id^="formfield-'+r+'"]').forEach((function(t){i(t,"id","formfield-"+r)}),this),t.querySelectorAll('[name^="'+n+'"]').forEach((function(t){i(t,"name",n)}),this),t.querySelectorAll('[id^="'+r+'"]').forEach((function(t){i(t,"id",r)}),this),t.querySelectorAll('[for^="'+r+'"]').forEach((function(t){i(t,"for",r)}),this),t.querySelectorAll('[href*="#'+r+'"]').forEach((function(t){i(t,"href","#"+r)}),this),t.querySelectorAll('[data-fieldname^="'+n+'"]').forEach((function(t){i(t,"data-fieldname",n)}),this)},updateOrderIndex:function(){var t=0;this.getRows().forEach((function(e){var n=e.dataset.index;["AA","TT"].indexOf(n)>-1?this.reindexRow(e,n):(this.reindexRow(e,t),e.dataset.index=t,t++)}),this);var e=this.el_body.dataset.name_prefix+".";this.el.querySelector('input[name="'+e+'count"]').value=this.countRows(),this.setUIState()},getParentRow:function(t){var e=t.closest(".datagridwidget-row");return e||null},ensureMinimumRows:function(){var t=this.getRows(),e=this.getVisibleRows();return!(!t.length||0!==e.length)&&(this.auto_append_row(),!0)}});T.init()}()}();
//# sourceMappingURL=datagridfield.min.js.map